<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>implements the generalized miscall + dropout model — combine_miscalls_and_dropouts • CKMRsim</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="implements the generalized miscall + dropout model — combine_miscalls_and_dropouts"><meta property="og:description" content="This is the version into which you pass in your own matrices of allele
call probabilities W (corresponding to omega) and Ws (omega-star)
and vectors of allele-specific dropout rates. Notation follows the paper
for the most part. So see it for details."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CKMRsim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/CKMRsim-developer-notes.html">CKMRsim-developer-notes</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-example-1.html">CKMRsim-example-1</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-example-2-microsatellites.html">CKMRsim-example-2-microsatellites</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-pairwise-relationships.html">CKMRsim-pairwise-relationships</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-simulating-linked-markers.html">Simulating-linked-markers</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-writing-geno-error-funcs.html">CKMRsim-writing-geno-error-functions</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>implements the generalized miscall + dropout model</h1>
    
    <div class="hidden name"><code>combine_miscalls_and_dropouts.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the version into which you pass in your own matrices of allele
call probabilities W (corresponding to omega) and Ws (omega-star)
and vectors of allele-specific dropout rates. Notation follows the paper
for the most part. So see it for details.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">combine_miscalls_and_dropouts</span><span class="op">(</span><span class="va">geno_names</span>, <span class="va">D</span>, <span class="va">W</span>, <span class="va">Ws</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>geno_names</dt>
<dd><p>the names of the genotypes in the order that CKMRsim has
stored them.</p></dd>


<dt>D</dt>
<dd><p>vector of allele-specific dropout rates (delta) in the paper. Must be named
with the names of the alleles, and should be in the correct order (that which CKMRsim uses).</p></dd>


<dt>W</dt>
<dd><p>the matrix omega of allelic call probabilities. Must have rownames and colnames that
are the allele names, and have to be in the correct order.</p></dd>


<dt>Ws</dt>
<dd><p>the matrix omega* of allelic call probabilities.  Gotta have rownames and colnames.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>This function returns matrix C, which is the genotype-call probability matrix.  The element
in the s-th row and the t-th column gives the probability that a true genotype
of index s is called as a genotype of index t.  This matrix is returned with rownames and colnames
which are the genotype names using the standard CKMRsim alelle separator of " / ".</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The old version (general_allele_based_geno_err_model) required that
the variables g, gp, h, and gp all
be input by the user.  This version just uses the names attribute of the
geno_freqs variable to take care of that.  In other words, you pass
it a character vector of genotype names (constructed by CKMRsim using the
standard allele separate, " / ", and this function creates the g, gp, h, and hp
vectors that are needed.)</p>
<p>Note that this is vectorized
over g, gp, h, and hp.  Note that g, gp, h, and hp can be character vectors
giving the allele names, so long as the vector D has names which are the allele
names and W and Ws have rownames and colnames which are the allele names.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># simple example with 2-allele locus.</span></span></span>
<span class="r-in"><span><span class="co"># first, look at the relevant information you would have about a locus,</span></span></span>
<span class="r-in"><span><span class="co"># namely the allele frequencies and the genotype frequencies</span></span></span>
<span class="r-in"><span><span class="va">example_L_biallelic</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $freqs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A   B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6 0.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $geno_freqs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A / A A / B B / B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.36  0.48  0.16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now, we create a matrix of allele-to-allele mis-call rates.</span></span></span>
<span class="r-in"><span><span class="co"># Let's say that with probability 0.01 you miscall a true A as a B</span></span></span>
<span class="r-in"><span><span class="co"># and with probability 0.03 you miscall a true B as an A.  We set</span></span></span>
<span class="r-in"><span><span class="co"># these as different just because it provides a better illustration here.</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="fl">0.03</span>, <span class="fl">0.97</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Have a look at that:</span></span></span>
<span class="r-in"><span><span class="va">W</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      A    B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 0.99 0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B 0.03 0.97</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Ws is a matrix of similar form that specifies the miscall rates given that</span></span></span>
<span class="r-in"><span><span class="co"># a dropout occurred.  We will set it to be the same as W for this example:</span></span></span>
<span class="r-in"><span><span class="va">Ws</span> <span class="op">&lt;-</span> <span class="va">W</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now we need a vector of allele-specific dropout rates. Let's say that</span></span></span>
<span class="r-in"><span><span class="co"># A is very likely to drop out (0.05) and B, not so much (0.02)</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0.05</span>, B <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See what the resulting genotype-call probability matrix looks like:</span></span></span>
<span class="r-in"><span><span class="fu">combine_miscalls_and_dropouts</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">example_L_biallelic</span><span class="op">$</span><span class="va">geno_freqs</span><span class="op">)</span>, <span class="va">D</span>, <span class="va">W</span>, <span class="va">Ws</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          A / A    A / B    B / B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A / A 0.981090 0.017820 0.001090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A / B 0.048921 0.893358 0.057721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B / B 0.002064 0.055872 0.942064</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now, let's see what it looks like if it is only the dropouts, no miscalls</span></span></span>
<span class="r-in"><span><span class="va">W2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">W2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">W2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span>  <span class="co"># recall, you must have row and column names on these</span></span></span>
<span class="r-in"><span><span class="va">Ws2</span> <span class="op">&lt;-</span> <span class="va">W2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">combine_miscalls_and_dropouts</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">example_L_biallelic</span><span class="op">$</span><span class="va">geno_freqs</span><span class="op">)</span>, <span class="va">D</span>, <span class="va">W2</span>, <span class="va">Ws2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       A / A A / B B / B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A / A  1.00  0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A / B  0.02  0.93  0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B / B  0.00  0.00  1.00</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Eric C. Anderson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

