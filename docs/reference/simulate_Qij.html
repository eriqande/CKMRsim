<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>compute the all-locus genotype pair probs for pairs simulated given specified relationships — simulate_Qij • CKMRsim</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="compute the all-locus genotype pair probs for pairs simulated given specified relationships — simulate_Qij"><meta property="og:description" content="After you have created a ckmr object with create_ckmr, then
it is time to simulate multilocus genotype pairs under all the
relationships that you want to simulate from, and compute the likelihood of those
relationships under different relationship hypotheses.
This function does that."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CKMRsim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/CKMRsim-developer-notes.html">CKMRsim-developer-notes</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-example-1.html">CKMRsim-example-1</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-example-2-microsatellites.html">CKMRsim-example-2-microsatellites</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-pairwise-relationships.html">CKMRsim-pairwise-relationships</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-simulating-linked-markers.html">Simulating-linked-markers</a>
    </li>
    <li>
      <a href="../articles/CKMRsim-writing-geno-error-funcs.html">CKMRsim-writing-geno-error-functions</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>compute the all-locus genotype pair probs for pairs simulated given specified relationships</h1>
    
    <div class="hidden name"><code>simulate_Qij.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>After you have created a ckmr object with <code><a href="create_ckmr.html">create_ckmr</a></code>, then
it is time to simulate multilocus genotype pairs under all the
relationships that you want to simulate from, and compute the likelihood of those
relationships under different relationship hypotheses.
This function does that.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulate_Qij</span><span class="op">(</span></span>
<span>  <span class="va">C</span>,</span>
<span>  <span class="va">sim_relats</span>,</span>
<span>  <span class="va">calc_relats</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span>,</span>
<span>  unlinked <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  forceLinkagePO <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pedigree_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  miss_mask_mat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rando_miss_wts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rando_miss_n <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">froms</span>,</span>
<span>  <span class="va">tos</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>C</dt>
<dd><p>the ckmr object upon which to base the simulations.</p></dd>


<dt>sim_relats</dt>
<dd><p>a vector of names of the relationship IDs (these were the rownames
in the <code>kappa_matrix</code> argument to <code><a href="create_ckmr.html">create_ckmr</a></code> to simulate from.
For each relationship ID in sim_relats, genotype values will get simulated
from the <code>Y_l_true</code> values in <code>C</code>.</p></dd>


<dt>calc_relats</dt>
<dd><p>a vector of names of the relationship IDs to calculate the
genotype log probabilities of the simulated
genotypes from.  Genotype log probs are calculated using the Y_l matrices.</p></dd>


<dt>reps</dt>
<dd><p>a synonym for <code>calc_relats</code> for compatibility to an earlier version
of CKMRsim.</p></dd>


<dt>unlinked</dt>
<dd><p>A logical indicating whether to simulate the markers as unlinked.  By default this is
TRUE.  If FALSE, then genotypes at linked markers will be simulated using the program MENDEL, genotyping
errors will be applied to them, and the Q_ij values themselves will still be computed under the assumption
of no linkage. However, they will be simulated under the no-linkage model for relationships "U", "PO", and
"MZ", because, in the absence of LD, related pairs under those relationships are not affected by
physical linkage.</p></dd>


<dt>forceLinkagePO</dt>
<dd><p>If you really want to force simulation to be done under physical linkage for the PO case
(perhaps to verify that you get the same result as with unlinked.  Pass TRUE to this while <code>unlinked</code> is
FALSE.)</p></dd>


<dt>pedigree_list</dt>
<dd><p>If you specify unlinked == FALSE, then you have to supply a pedigree_list.</p></dd>


<dt>miss_mask_mat</dt>
<dd><p>A logical matrix with length(YL) columns and reps rows.  The (r,c)-th is TRUE if
the c-th locus should be considered missing in the r-th simulated sample.  This type of specification
lets the user simulate either a specific pattern of missingness, if desired, or to simulate patterns of
missing data given missing data rates, etc.</p></dd>


<dt>rando_miss_wts</dt>
<dd><p>weights to be given to different loci that influence whether they
will be one of the rando_miss_n missing loci in any iteration.  These will be recycled
(or truncated) to have length equal to the number of loci, and they will be normalized
to sum to one as appropriate (so you can provide
them in unnormalized form.) The idea of this is to be able to use observed rates of
missingness amongst loci to mask some loci as missing.  Given as a comma-delimited
string in column "rando_miss_wts" in the output.</p></dd>


<dt>rando_miss_n</dt>
<dd><p>a single number less than the number of loci.  Each iteration,
rando_miss_n loci will be considered missing, according to the rando_miss_wts.  This
let's you get a sense for how well you will do, on average, with a certain number of
missing loci.</p></dd>


<dt>froms</dt>
<dd><p>a synonym for <code>sim_relats</code> for compatibility to an earlier version
of CKMRsim.</p></dd>


<dt>tos</dt>
<dd><p>a synonym for <code>calc_relats</code> for compatibility to an earlier version
of CKMRsim.</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Eric C. Anderson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

